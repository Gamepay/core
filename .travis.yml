language: php

php:
  - 5.4
  - 5.5
  - 5.6
  - hhvm
  - hhvm-nightly

matrix:
  allow_failures:
    - php: hhvm

before_script:
  - URL=$(curl -si https://github.com/xp-framework/xp-runners/releases/latest | awk '/^Location: / { print $2; }' | tr -d '\r' | sed -e 's|/tag/|/download/|')
  - curl -sL $URL/setup | php
  - echo "use=." > xp.ini
  - echo "[runtime]" >> xp.ini
  - echo "date.timezone=Europe/Berlin" >> xp.ini

script:
  - (EXCD=0; for i in src/test/config/unittest/*.ini; do echo "---> $i"; ./unittest $i; RES=$?; if [ $RES -ne 0 ]; then EXCD=$RES; fi; done; exit $EXCD;)
